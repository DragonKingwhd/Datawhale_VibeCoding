# Task 01: è´ªåƒè›‡è¯—æ­Œæ¸¸æˆ

## ğŸ“‘ ç›®å½•

- [å­¦ä¹ æ”¶è·](#å­¦ä¹ æ”¶è·)
- [ä»»åŠ¡è¯´æ˜](#ä»»åŠ¡è¯´æ˜)
- [æ¸¸æˆæ¼”ç¤º](#æ¸¸æˆæ¼”ç¤º)
- [æ¸¸æˆç©æ³•](#æ¸¸æˆç©æ³•)
- [è¿è¡Œé¡¹ç›®](#è¿è¡Œé¡¹ç›®)
- [é—®é¢˜è°ƒè¯•](#é—®é¢˜è°ƒè¯•)
  - [é—®é¢˜ 1ï¼štee å‘½ä»¤é”™è¯¯](#é—®é¢˜-1tee-å‘½ä»¤é”™è¯¯)
  - [é—®é¢˜ 2ï¼šç«¯å£è¢«å ç”¨](#é—®é¢˜-2ç«¯å£è¢«å ç”¨)
  - [é—®é¢˜ 3ï¼šé”®ç›˜æ–¹å‘é”®æ— æ³•æ§åˆ¶](#é—®é¢˜-3é”®ç›˜æ–¹å‘é”®æ— æ³•æ§åˆ¶)
  - [é—®é¢˜ 4ï¼šæ¸¸æˆå¼€å§‹åè›‡ä¸åŠ¨](#é—®é¢˜-4æ¸¸æˆå¼€å§‹åè›‡ä¸åŠ¨)
- [æŠ€æœ¯åˆ†æ](#æŠ€æœ¯åˆ†æ)
- [ç›¸å…³æ–‡ä»¶](#ç›¸å…³æ–‡ä»¶)

---

## å­¦ä¹ æ”¶è·

### ç¬¬ä¸€ç‚¹æ”¶è·
ã€Šè¯·å…ˆç”¨ 5 å¥è¯è®²æ¸…æ¥šè¿™ä¸ªæ¦‚å¿µï¼Œå†ç»™å‡ ä¸ªé—®é¢˜æé—®æˆ‘éªŒè¯æˆ‘ç†è§£å¯¹äº†æ²¡ã€‚ã€‹

è¿™ä¸ªç‚¹æ˜¯æˆ‘ä¹‹å‰ä½¿ç”¨ vibecoding ä»æ¥æ²¡æœ‰è€ƒè™‘åˆ°çš„ä¸€ä¸ªç‚¹ï¼Œæˆ–è®¸è¿™ä¸ªæ‰æ˜¯è®©è‡ªèº«æˆé•¿çš„ä¸€ä¸ªé‡è¦å› ç´ ï¼Œè€Œä¸æ˜¯ä¸€å‘³ç´¢å–ç­”æ¡ˆï¼

### ç¬¬äºŒç‚¹æ”¶è·
ã€Šæˆ‘ä»¬è¿˜å¯ä»¥è¦æ±‚ LLM å¸®ä½ ç›´æ¥ç”Ÿæˆé¡¹ç›®çº§çš„æç¤ºè¯ã€‚åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬åªè‡ªå·±å†™äº†è´ªåƒè›‡æ¸¸æˆçš„æç¤ºè¯ã€‚ç°åœ¨è®©æˆ‘ä»¬å°è¯•è®©å¤§æ¨¡å‹ç”Ÿæˆä¸€ä¸ªå¸¦æœ‰æ•´ä½“æ¡†æ¶å’Œå®ç°è·¯å¾„çš„æç¤ºè¯ã€‚ã€‹

è¿™ä¸ªå¯ä»¥åœ¨æœ¬èº«æè¿°ä¸å¤Ÿä¸“ä¸šçš„æƒ…å†µï¼Œè®© AI ç»“åˆä¸“ä¸šè¯æ±‡ç”Ÿæˆå‘½ä»¤æ„å»ºæç¤ºè¯æ±‡ã€‚

### ç¬¬ä¸‰ç‚¹æ”¶è·
ç³»ç»Ÿå­¦ä¹ äº†å‰ç«¯ç½‘é¡µçš„å®ç°ä»¥åŠæ¡†æ¶çš„é‡è¦æ€§ã€‚

---

## ä»»åŠ¡è¯´æ˜

### ä»»åŠ¡ç›®æ ‡
1. å¤ç° AI åŸç”Ÿçš„è´ªåƒè›‡æ¸¸æˆ
2. ï¼ˆå¯é€‰ï¼‰æ ¹æ®æ›´å¤šå‚è€ƒæ¡ˆä¾‹å®ç°ä¸åŒç§ç±»å¥½ç©çš„ AI åŸç”Ÿæ¸¸æˆ

### é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªç”± Z.ai ç”Ÿæˆçš„ Next.js é¡¹ç›®ï¼ŒåŒ…å«ä¸€ä¸ªåˆ›æ„çš„è´ªåƒè›‡æ¸¸æˆã€‚æ¸¸æˆç©æ³•ï¼š
- æ§åˆ¶è›‡æ”¶é›†æ±‰å­—
- æ”¶é›† 8 ä¸ªæ±‰å­—åï¼ŒAI ä¼šæ ¹æ®è¿™äº›æ±‰å­—åˆ›ä½œä¸€é¦–è¯—
- å¯ä»¥æ ¹æ®è¯—æ­Œç”Ÿæˆå¯¹åº”çš„å›¾åƒ

### é¡¹ç›®æŠ€æœ¯æ ˆ

- **æ¡†æ¶**ï¼šNext.js 15 + React 18
- **è¯­è¨€**ï¼šTypeScript 5
- **æ ·å¼**ï¼šTailwind CSS 4 + shadcn/ui
- **çŠ¶æ€ç®¡ç†**ï¼šReact Hooks (useState, useEffect, useCallback, useRef)
- **åç«¯**ï¼šNext.js API Routes
- **æ•°æ®åº“**ï¼šPrisma ORM
- **è®¤è¯**ï¼šNextAuth.js

---

## æ¸¸æˆæ¼”ç¤º

### æ¸¸æˆç•Œé¢
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ è´ªåƒè›‡è¯—æ­Œæ¸¸æˆ                                    â”‚
â”‚  æ”¶é›†8ä¸ªæ±‰å­—ï¼ŒAIå°†ä¸ºä½ åˆ›ä½œä¸€é¦–è¯—                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          â”‚  â”‚  ğŸ“¦ å•è¯æ”¶é›†ç›’        â”‚
â”‚      æ¸¸æˆåŒºåŸŸ            â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚    (20Ã—20 ç½‘æ ¼)          â”‚  â”‚  [æ™¨] [æ›¦] [æ¢¦]      â”‚
â”‚                          â”‚  â”‚  [æƒ³] [æ˜Ÿ] [å…‰]      â”‚
â”‚  ğŸ è›‡                   â”‚  â”‚  è¿›åº¦: 6/8           â”‚
â”‚  ğŸŸ¦ æ±‰å­—                 â”‚  â”‚                      â”‚
â”‚                          â”‚  â”‚  âœ¨ AIè¯—æ­Œ          â”‚
â”‚                          â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚                          â”‚  â”‚  æ™¨æ›¦æ¢¦æƒ³æ˜Ÿå…‰æµ·æ´‹    â”‚
â”‚                          â”‚  â”‚  å±±å³°æ˜¥é£ç§‹æœˆ...     â”‚
â”‚                          â”‚  â”‚                      â”‚
â”‚                          â”‚  â”‚  [ğŸ”„ é‡æ–°æ··åˆ]      â”‚
â”‚                          â”‚  â”‚  [ğŸ¨ ç”Ÿæˆå›¾åƒ]      â”‚
â”‚                          â”‚  â”‚  [ğŸ”„ å†ç©ä¸€æ¬¡]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ¸¸æˆç©æ³•

### æ¸¸æˆè§„åˆ™
1. ç‚¹å‡»"å¼€å§‹æ¸¸æˆ"æŒ‰é’®å¼€å§‹
2. è›‡ä¼šè‡ªåŠ¨å‘å³ç§»åŠ¨
3. ä½¿ç”¨æ–¹å‘é”®ï¼ˆâ¬†ï¸ â¬‡ï¸ â¬…ï¸ â¡ï¸ï¼‰æ”¹å˜è›‡çš„æ–¹å‘
4. è›‡ç§»åŠ¨åˆ°æ±‰å­—ä½ç½®æ—¶è‡ªåŠ¨æ”¶é›†
5. æ¯æ”¶é›†ä¸€ä¸ªæ±‰å­—å¾— 10 åˆ†
6. æ”¶é›† 8 ä¸ªæ±‰å­—åæ¸¸æˆç»“æŸ
7. AI æ ¹æ®æ”¶é›†çš„æ±‰å­—åˆ›ä½œä¸€é¦–è¯—

### æ¸¸æˆç»“æŸæ¡ä»¶
- âŒ è›‡ç¢°åˆ°è¾¹ç•Œ
- âŒ è›‡ç¢°åˆ°è‡ªå·±çš„èº«ä½“
- âœ… æ”¶é›† 8 ä¸ªæ±‰å­—ï¼ˆæˆåŠŸï¼‰

### æ¸¸æˆå‚æ•°
- **ç½‘æ ¼å¤§å°**ï¼š20Ã—20
- **å•å…ƒæ ¼å¤§å°**ï¼š20px
- **æ¸¸æˆé€Ÿåº¦**ï¼š200ms/æ­¥
- **ç›®æ ‡æ±‰å­—æ•°**ï¼š8 ä¸ª
- **æ¯ä¸ªæ±‰å­—åˆ†æ•°**ï¼š10 åˆ†

---

## è¿è¡Œé¡¹ç›®

### å¿«é€Ÿå¯åŠ¨ï¼ˆWindows PowerShellï¼‰

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd C:\Users\15875\Desktop\Github\Datawhale_VibeCoding\task_01

# 2. å®‰è£…ä¾èµ–ï¼ˆé¦–æ¬¡è¿è¡Œï¼‰
npm install

# 3. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# 4. æ‰“å¼€æµè§ˆå™¨
# http://localhost:3000
```

### ä½¿ç”¨å…¶ä»–ç«¯å£
```bash
npm run dev -- -p 3001
# ç„¶åè®¿é—® http://localhost:3001
```

### å…¶ä»–å‘½ä»¤
```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build

# å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
npm start

# è¿è¡Œ linter
npm run lint
```

---

## é—®é¢˜è°ƒè¯•

### é—®é¢˜ 1ï¼štee å‘½ä»¤é”™è¯¯

**é”™è¯¯ä¿¡æ¯**ï¼š
```
'tee' ä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤ï¼Œä¹Ÿä¸æ˜¯å¯è¿è¡Œçš„ç¨‹åºæˆ–æ‰¹å¤„ç†æ–‡ä»¶ã€‚
```

**åŸå› **ï¼šWindows PowerShell ä¸æ”¯æŒ `tee` å‘½ä»¤ï¼ˆè¿™æ˜¯ Linux/Mac çš„å‘½ä»¤ï¼‰

**è§£å†³**ï¼šå·²åœ¨ `package.json` ä¸­ä¿®å¤ï¼Œç›´æ¥è¿è¡Œ `npm run dev` å³å¯

**ä¿®æ”¹å†…å®¹**ï¼š
```json
// ä¿®æ”¹å‰
"dev": "next dev -p 3000 2>&1 | tee dev.log"

// ä¿®æ”¹å
"dev": "next dev -p 3000"
```

---

### é—®é¢˜ 2ï¼šç«¯å£è¢«å ç”¨

**é”™è¯¯ä¿¡æ¯**ï¼š
```
Error: listen EADDRINUSE: address already in use :::3000
```

**åŸå› **ï¼šç«¯å£ 3000 å·²è¢«å…¶ä»–è¿›ç¨‹å ç”¨ï¼ˆé€šå¸¸æ˜¯ä¹‹å‰çš„å¼€å‘æœåŠ¡å™¨è¿˜åœ¨è¿è¡Œï¼‰

**è§£å†³æ–¹æ¡ˆ**ï¼š

**æ–¹æ¡ˆ Aï¼šä½¿ç”¨å…¶ä»–ç«¯å£ï¼ˆæ¨èï¼Œæœ€å¿«ï¼‰**
```powershell
npm run dev -- -p 3001
```
ç„¶åè®¿é—® `http://localhost:3001`

**æ–¹æ¡ˆ Bï¼šæ‰‹åŠ¨åœæ­¢å ç”¨ç«¯å£çš„è¿›ç¨‹**
```powershell
# æŸ¥æ‰¾å ç”¨ 3000 ç«¯å£çš„è¿›ç¨‹
Get-NetTCPConnection -LocalPort 3000 | Select-Object OwningProcess

# åœæ­¢è¿›ç¨‹ï¼ˆæ›¿æ¢ PID ä¸ºä¸Šé¢æŸ¥åˆ°çš„è¿›ç¨‹ IDï¼‰
Stop-Process -Id <PID> -Force

# ç„¶åé‡æ–°è¿è¡Œ
npm run dev
```

**æ–¹æ¡ˆ Cï¼šä¿®æ”¹é»˜è®¤ç«¯å£**

ç¼–è¾‘ `package.json`ï¼Œå°†ï¼š
```json
"dev": "next dev -p 3000"
```
æ”¹ä¸ºï¼š
```json
"dev": "next dev -p 3001"
```

ç„¶åè¿è¡Œ `npm run dev`ï¼Œæ¸¸æˆä¼šåœ¨ `http://localhost:3001` å¯åŠ¨

---

### é—®é¢˜ 3ï¼šé”®ç›˜æ–¹å‘é”®æ— æ³•æ§åˆ¶

**é—®é¢˜æè¿°**ï¼šç‚¹å‡»"å¼€å§‹æ¸¸æˆ"åï¼Œé”®ç›˜æ–¹å‘é”®æ— æ³•æ§åˆ¶è›‡çš„ç§»åŠ¨

**æ ¹æœ¬åŸå› **ï¼š**React Hooks é—­åŒ…é™·é˜±**

é—®é¢˜ä½äº `src/app/page.tsx` çš„ç¬¬ 188-214 è¡Œçš„é”®ç›˜äº‹ä»¶ç›‘å¬å™¨ï¼š

```typescript
useEffect(() => {
  const handleKeyDown = (e: KeyboardEvent) => {
    if (gameStatus !== 'playing') return  // âŒ é—­åŒ…é™·é˜±

    switch (e.key) {
      case 'ArrowUp':
        e.preventDefault()
        setNextDirection(prev => prev.y === 1 ? prev : { x: 0, y: -1 })
        break
      // ... å…¶ä»–æ–¹å‘é”®
    }
  }

  window.addEventListener('keydown', handleKeyDown)
  return () => window.removeEventListener('keydown', handleKeyDown)
}, [gameStatus])  // âŒ é¢‘ç¹é‡æ–°æ³¨å†Œ
```

**å…·ä½“é—®é¢˜**ï¼š
1. **é—­åŒ…é™·é˜±**ï¼š`handleKeyDown` å‡½æ•°åœ¨åˆ›å»ºæ—¶ä¼šæ•è·å½“å‰çš„ `gameStatus` å€¼ã€‚å¦‚æœäº‹ä»¶ç›‘å¬å™¨æ²¡æœ‰åŠæ—¶æ›´æ–°ï¼Œå®ƒä¼šç»§ç»­ä½¿ç”¨æ—§çš„ `gameStatus` å€¼ã€‚
2. **ä¾èµ–æ•°ç»„é—®é¢˜**ï¼šè™½ç„¶ä¾èµ–æ•°ç»„åŒ…å« `[gameStatus]`ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒReact çš„äº‹ä»¶å§”æ‰˜å’Œæµè§ˆå™¨çš„äº‹ä»¶å¤„ç†å¯èƒ½å¯¼è‡´ç›‘å¬å™¨æ²¡æœ‰æ­£ç¡®æ›´æ–°ã€‚
3. **äº‹ä»¶ç›‘å¬å™¨æ—¶åºé—®é¢˜**ï¼šæ¸¸æˆçŠ¶æ€æ”¹å˜æ—¶ï¼Œæ–°çš„äº‹ä»¶ç›‘å¬å™¨å¯èƒ½è¿˜æ²¡æœ‰å®Œå…¨æ³¨å†Œï¼Œç”¨æˆ·å·²ç»å¼€å§‹æŒ‰é”®ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š

ä½¿ç”¨ `useRef` æ¥å­˜å‚¨å½“å‰çš„æ¸¸æˆçŠ¶æ€ï¼Œé¿å…é—­åŒ…é—®é¢˜ï¼š

#### ä¿®æ”¹ 1ï¼šå¯¼å…¥ useRef
```typescript
import { useState, useEffect, useCallback, useRef } from 'react'
```

#### ä¿®æ”¹ 2ï¼šæ·»åŠ  gameStatusRef
åœ¨ç»„ä»¶ä¸­æ·»åŠ ï¼š
```typescript
const gameStatusRef = useRef(gameStatus)
```

#### ä¿®æ”¹ 3ï¼šæ·»åŠ  ref åŒæ­¥ effect
```typescript
useEffect(() => {
  gameStatusRef.current = gameStatus
}, [gameStatus])
```

#### ä¿®æ”¹ 4ï¼šä¿®å¤é”®ç›˜äº‹ä»¶ effect
å°†åŸå§‹çš„é”®ç›˜äº‹ä»¶ effect æ›¿æ¢ä¸ºï¼š
```typescript
useEffect(() => {
  const handleKeyDown = (e: KeyboardEvent) => {
    if (gameStatusRef.current !== 'playing') return  // âœ… ä½¿ç”¨ ref

    switch (e.key) {
      case 'ArrowUp':
        e.preventDefault()
        setNextDirection(prev => prev.y === 1 ? prev : { x: 0, y: -1 })
        break
      case 'ArrowDown':
        e.preventDefault()
        setNextDirection(prev => prev.y === -1 ? prev : { x: 0, y: 1 })
        break
      case 'ArrowLeft':
        e.preventDefault()
        setNextDirection(prev => prev.x === 1 ? prev : { x: -1, y: 0 })
        break
      case 'ArrowRight':
        e.preventDefault()
        setNextDirection(prev => prev.x === -1 ? prev : { x: 1, y: 0 })
        break
    }
  }

  window.addEventListener('keydown', handleKeyDown)
  return () => window.removeEventListener('keydown', handleKeyDown)
}, [])  // âœ… ç©ºä¾èµ–æ•°ç»„ï¼Œäº‹ä»¶ç›‘å¬å™¨åªæ³¨å†Œä¸€æ¬¡
```

---

### é—®é¢˜ 4ï¼šæ¸¸æˆå¼€å§‹åè›‡ä¸åŠ¨

**é—®é¢˜æè¿°**ï¼šç‚¹å‡»"å¼€å§‹æ¸¸æˆ"åï¼Œè›‡æ²¡æœ‰è‡ªåŠ¨ç§»åŠ¨

**åŸå› **ï¼šåˆå§‹æ–¹å‘ä¸º `{ x: 0, y: 0 }`ï¼ˆæ— æ–¹å‘ï¼‰ï¼Œè›‡æ— æ³•ç§»åŠ¨

**è§£å†³æ–¹æ¡ˆ**ï¼š

ä¿®æ”¹ `startGame` å‡½æ•°ï¼Œè®©è›‡æ¸¸æˆå¼€å§‹æ—¶è‡ªåŠ¨å‘å³ç§»åŠ¨ï¼š

```typescript
const startGame = () => {
  setSnake([{ x: 10, y: 10 }])
  setDirection({ x: 1, y: 0 })  // âœ… æ”¹ä¸ºå‘å³ç§»åŠ¨
  setNextDirection({ x: 1, y: 0 })  // âœ… æ”¹ä¸ºå‘å³ç§»åŠ¨
  setWords([])
  setCollectedWords([])
  setGameStatus('playing')
  setScore(0)
  setPoem('')
  setGeneratedImage('')
}
```

---

## æŠ€æœ¯åˆ†æ

### React Hooks é—­åŒ…é—®é¢˜

**é—®é¢˜**ï¼šé—­åŒ…é™·é˜±
```typescript
// âŒ é—®é¢˜ä»£ç 
let gameStatus = 'idle'

const handleKeyDown = () => {
  console.log(gameStatus)  // å§‹ç»ˆæ‰“å° 'idle'
}

gameStatus = 'playing'
handleKeyDown()  // è¾“å‡ºï¼š'idle'ï¼ˆä¸æ˜¯ 'playing'ï¼ï¼‰
```

**è§£å†³æ–¹æ¡ˆ**ï¼šä½¿ç”¨ useRef
```typescript
// âœ… è§£å†³æ–¹æ¡ˆ
let gameStatusRef = { current: 'idle' }

const handleKeyDown = () => {
  console.log(gameStatusRef.current)  // å§‹ç»ˆæ‰“å°æœ€æ–°å€¼
}

gameStatusRef.current = 'playing'
handleKeyDown()  // è¾“å‡ºï¼š'playing'
```

### useRef vs useState

| ç‰¹æ€§ | useState | useRef |
|------|---------|--------|
| è§¦å‘é‡æ–°æ¸²æŸ“ | âœ… æ˜¯ | âŒ å¦ |
| è®¿é—®æœ€æ–°å€¼ | âœ… æ˜¯ | âœ… æ˜¯ |
| ç”¨é€” | UI çŠ¶æ€ | ä¸éœ€è¦è§¦å‘æ¸²æŸ“çš„å€¼ |
| æ›´æ–°æ–¹å¼ | setState | ref.current = value |

### äº‹ä»¶ç›‘å¬å™¨ç”Ÿå‘½å‘¨æœŸ

- **æ³¨å†Œ**ï¼š`addEventListener`
- **æ¸…ç†**ï¼š`removeEventListener`ï¼ˆåœ¨ effect çš„è¿”å›å‡½æ•°ä¸­ï¼‰
- **é¢‘ç¹æ³¨å†Œ/æ³¨é”€**ï¼šä¼šå½±å“æ€§èƒ½å’Œå¯é æ€§

---

## ç›¸å…³æ–‡ä»¶

- `src/app/page.tsx` - ä¸»æ¸¸æˆç»„ä»¶
- `src/app/api/generate-poem` - AI è¯—æ­Œç”Ÿæˆ API
- `src/app/api/generate-image` - AI å›¾åƒç”Ÿæˆ API
- `src/app/api/remix-poem` - è¯—æ­Œæ··åˆ API
- `src/components/ui/` - UI ç»„ä»¶åº“
- `package.json` - é¡¹ç›®é…ç½®

---

## AI è¯—æ­Œç”ŸæˆåŸç†

### æ•´ä½“æµç¨‹

```
ç”¨æˆ·æ”¶é›† 8 ä¸ªæ±‰å­—
        â†“
æ¸¸æˆç»“æŸï¼Œè°ƒç”¨ generate-poem API
        â†“
Z.ai LLM æ ¹æ®æ±‰å­—åˆ›ä½œè¯—æ­Œ
        â†“
è¯—æ­Œæ˜¾ç¤ºåœ¨é¡µé¢ä¸Š
        â†“
ç”¨æˆ·å¯ä»¥é€‰æ‹©ï¼š
  â”œâ”€ é‡æ–°æ··åˆè¯—æ­Œ â†’ remix-poem API
  â”œâ”€ ç”Ÿæˆå¯¹åº”å›¾åƒ â†’ generate-image API
  â””â”€ å†ç©ä¸€æ¬¡ â†’ é‡æ–°å¼€å§‹æ¸¸æˆ
```

### 1. è¯—æ­Œç”Ÿæˆï¼ˆgenerate-poemï¼‰

**è§¦å‘æ—¶æœº**ï¼šæ”¶é›† 8 ä¸ªæ±‰å­—å

**API æµç¨‹**ï¼š
```typescript
// 1. æ¥æ”¶å‰ç«¯å‘é€çš„æ±‰å­—æ•°ç»„
const { words } = await request.json()
// ä¾‹å¦‚ï¼š['æ™¨', 'æ›¦', 'æ¢¦', 'æƒ³', 'æ˜Ÿ', 'å…‰', 'æµ·', 'æ´‹']

// 2. åˆ›å»º Z.ai å®ä¾‹
const zai = await ZAI.create()

// 3. è°ƒç”¨ LLM ç”Ÿæˆè¯—æ­Œ
const completion = await zai.chat.completions.create({
  messages: [
    {
      role: 'assistant',
      content: 'ä½ æ˜¯ä¸€ä½ä¼˜ç§€çš„è¯—äººã€‚è¯·æ ¹æ®æä¾›çš„æ±‰å­—åˆ›ä½œä¸€é¦–ä¼˜ç¾çš„å¤ä½“è¯—æˆ–ç°ä»£è¯—ã€‚è¯—æ­Œè¦æ„å¢ƒä¼˜ç¾ï¼Œå¯Œæœ‰è¯—æ„ï¼Œè‡ªç„¶æµç•…ã€‚åªè¿”å›è¯—æ­Œå†…å®¹ï¼Œä¸è¦ä»»ä½•è§£é‡Šæˆ–æ ‡é¢˜ã€‚'
    },
    {
      role: 'user',
      content: `è¯·ç”¨è¿™äº›æ±‰å­—åˆ›ä½œä¸€é¦–è¯—ï¼šæ™¨ã€æ›¦ã€æ¢¦ã€æƒ³ã€æ˜Ÿã€å…‰ã€æµ·ã€æ´‹`
    }
  ],
  thinking: { type: 'disabled' }
})

// 4. æå–è¯—æ­Œå†…å®¹
const poem = completion.choices[0]?.message?.content || ''

// 5. è¿”å›ç»™å‰ç«¯
return NextResponse.json({ poem })
```

**å…³é”®ç‚¹**ï¼š
- ä½¿ç”¨ Z.ai çš„ LLM æ¨¡å‹ï¼ˆåŸºäº GLMï¼‰
- ç³»ç»Ÿæç¤ºè¯å®šä¹‰äº†è¯—äººè§’è‰²
- ç”¨æˆ·æç¤ºè¯åŒ…å«æ‰€æœ‰æ”¶é›†çš„æ±‰å­—
- ç¦ç”¨æ€è€ƒæ¨¡å¼ï¼ˆthinking: disabledï¼‰ä»¥åŠ å¿«å“åº”

### 2. è¯—æ­Œæ··åˆï¼ˆremix-poemï¼‰

**è§¦å‘æ—¶æœº**ï¼šç”¨æˆ·ç‚¹å‡»"é‡æ–°æ··åˆè¯—æ­Œ"æŒ‰é’®

**API æµç¨‹**ï¼š
```typescript
// 1. æ¥æ”¶åŸè¯—å’Œæ±‰å­—
const { poem, words } = await request.json()

// 2. è°ƒç”¨ LLM åˆ›ä½œæ–°è¯—
const completion = await zai.chat.completions.create({
  messages: [
    {
      role: 'assistant',
      content: 'ä½ æ˜¯ä¸€ä½ä¼˜ç§€çš„è¯—äººã€‚è¯·æ ¹æ®æä¾›çš„è¯—æ­Œåˆ›ä½œä¸€é¦–é£æ ¼ç›¸ä¼¼ä½†å†…å®¹ä¸åŒçš„æ–°è¯—ã€‚ä¿æŒåŸæœ‰çš„æ„å¢ƒå’ŒéŸµå‘³ï¼Œä½†ç”¨ä¸åŒçš„è¯è¯­å’Œè¡¨è¾¾æ–¹å¼ã€‚åªè¿”å›è¯—æ­Œå†…å®¹ï¼Œä¸è¦ä»»ä½•è§£é‡Šæˆ–æ ‡é¢˜ã€‚'
    },
    {
      role: 'user',
      content: `è¯·åŸºäºåŸè¯—åˆ›ä½œä¸€é¦–é£æ ¼ç›¸ä¼¼çš„æ–°è¯—ã€‚åŸè¯—ä½¿ç”¨çš„æ±‰å­—åŒ…æ‹¬ï¼šæ™¨ã€æ›¦ã€æ¢¦ã€æƒ³ã€æ˜Ÿã€å…‰ã€æµ·ã€æ´‹\n\nåŸè¯—ï¼š\n${åŸè¯—å†…å®¹}`
    }
  ],
  thinking: { type: 'disabled' }
})

// 3. è¿”å›æ–°è¯—
const newPoem = completion.choices[0]?.message?.content || ''
return NextResponse.json({ poem: newPoem })
```

**ç‰¹ç‚¹**ï¼š
- ä¿æŒåŸæœ‰é£æ ¼å’Œæ„å¢ƒ
- ä½¿ç”¨ä¸åŒçš„è¯è¯­å’Œè¡¨è¾¾æ–¹å¼
- å¯ä»¥å¤šæ¬¡ç‚¹å‡»ç”Ÿæˆä¸åŒç‰ˆæœ¬çš„è¯—æ­Œ

### 3. å›¾åƒç”Ÿæˆï¼ˆgenerate-imageï¼‰

**è§¦å‘æ—¶æœº**ï¼šç”¨æˆ·ç‚¹å‡»"æ ¹æ®è¯—æ­Œç”Ÿæˆå›¾åƒ"æŒ‰é’®

**API æµç¨‹**ï¼ˆä¸¤æ­¥ï¼‰ï¼š

**ç¬¬ä¸€æ­¥ï¼šç”Ÿæˆå›¾åƒæç¤ºè¯**
```typescript
// 1. æ ¹æ®è¯—æ­Œç”Ÿæˆè‹±æ–‡å›¾åƒæç¤ºè¯
const promptCompletion = await zai.chat.completions.create({
  messages: [
    {
      role: 'assistant',
      content: 'ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„å›¾åƒæç¤ºè¯è®¾è®¡å¸ˆã€‚è¯·æ ¹æ®æä¾›çš„è¯—æ­Œåˆ›ä½œä¸€ä¸ªè¯¦ç»†ã€æè¿°æ€§çš„è‹±æ–‡å›¾åƒæç¤ºè¯ï¼Œç”¨äºAIå›¾åƒç”Ÿæˆã€‚æç¤ºè¯åº”è¯¥æè¿°è¯—æ­Œä¸­çš„æ„å¢ƒã€è‰²å½©ã€æ°›å›´å’Œä¸»è¦å…ƒç´ ã€‚åªè¿”å›å›¾åƒæç¤ºè¯ï¼Œä¸è¦ä»»ä½•å…¶ä»–å†…å®¹ã€‚'
    },
    {
      role: 'user',
      content: `æ ¹æ®è¿™é¦–è¯—åˆ›ä½œä¸€ä¸ªå›¾åƒç”Ÿæˆæç¤ºè¯ï¼š\n${è¯—æ­Œå†…å®¹}`
    }
  ],
  thinking: { type: 'disabled' }
})

const prompt = promptCompletion.choices[0]?.message?.content
// ä¾‹å¦‚ï¼š'A serene landscape with dawn breaking over misty mountains,
// golden light reflecting on calm waters, ethereal and dreamlike atmosphere'
```

**ç¬¬äºŒæ­¥ï¼šç”Ÿæˆå›¾åƒ**
```typescript
// 2. ä½¿ç”¨æç¤ºè¯ç”Ÿæˆå›¾åƒ
const response = await zai.images.generations.create({
  prompt: prompt,
  size: '1344x768'
})

// 3. å°†å›¾åƒè½¬æ¢ä¸º Base64 æ•°æ® URL
const imageBase64 = response.data[0].base64
const imageDataUrl = `data:image/png;base64,${imageBase64}`

// 4. è¿”å›ç»™å‰ç«¯
return NextResponse.json({ image: imageDataUrl, prompt })
```

**ç‰¹ç‚¹**ï¼š
- ä¸¤æ­¥ç”Ÿæˆï¼šå…ˆç”Ÿæˆæç¤ºè¯ï¼Œå†ç”Ÿæˆå›¾åƒ
- æç¤ºè¯æ˜¯è‹±æ–‡ï¼ˆAI å›¾åƒæ¨¡å‹é€šå¸¸ä½¿ç”¨è‹±æ–‡ï¼‰
- å›¾åƒå°ºå¯¸ï¼š1344Ã—768
- è¿”å› Base64 æ ¼å¼çš„å›¾åƒæ•°æ®

### 4. å‰ç«¯è°ƒç”¨æµç¨‹

**åœ¨ `src/app/page.tsx` ä¸­**ï¼š

```typescript
// æ”¶é›† 8 ä¸ªæ±‰å­—åè°ƒç”¨
const generatePoem = async (wordList: string[]) => {
  setLoading(true)
  try {
    const response = await fetch('/api/generate-poem', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ words: wordList })
    })
    const data = await response.json()
    setPoem(data.poem)
  } catch (error) {
    console.error('Error generating poem:', error)
  }
  setLoading(false)
}

// é‡æ–°æ··åˆè¯—æ­Œ
const remixPoem = async () => {
  setLoading(true)
  try {
    const response = await fetch('/api/remix-poem', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ poem, words: collectedWords })
    })
    const data = await response.json()
    setPoem(data.poem)
  } catch (error) {
    console.error('Error remixing poem:', error)
  }
  setLoading(false)
}

// ç”Ÿæˆå›¾åƒ
const generateImageFromPoem = async () => {
  setLoading(true)
  setGameStatus('image')
  try {
    const response = await fetch('/api/generate-image', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ poem })
    })
    const data = await response.json()
    setGeneratedImage(data.image)
  } catch (error) {
    console.error('Error generating image:', error)
  }
  setLoading(false)
}
```

### 5. ä½¿ç”¨çš„ AI æœåŠ¡

**Z.ai SDK**ï¼š
- æä¾›å•†ï¼šZ.aiï¼ˆåŸºäº GLM å¤§æ¨¡å‹ï¼‰
- æ–‡æœ¬ç”Ÿæˆï¼š`zai.chat.completions.create()`
- å›¾åƒç”Ÿæˆï¼š`zai.images.generations.create()`

**ç³»ç»Ÿæç¤ºè¯è®¾è®¡**ï¼š
- **è¯—æ­Œç”Ÿæˆ**ï¼šå®šä¹‰ä¸º"ä¼˜ç§€çš„è¯—äºº"è§’è‰²
- **è¯—æ­Œæ··åˆ**ï¼šè¦æ±‚ä¿æŒé£æ ¼ä½†æ”¹å˜å†…å®¹
- **å›¾åƒæç¤ºè¯**ï¼šå®šä¹‰ä¸º"ä¸“ä¸šçš„å›¾åƒæç¤ºè¯è®¾è®¡å¸ˆ"è§’è‰²

### 6. å·¥ä½œæµæ€»ç»“

| æ­¥éª¤ | æ“ä½œ | API | è¾“å…¥ | è¾“å‡º |
|------|------|-----|------|------|
| 1 | æ”¶é›†æ±‰å­— | - | ç”¨æˆ·æ“ä½œ | 8 ä¸ªæ±‰å­— |
| 2 | ç”Ÿæˆè¯—æ­Œ | generate-poem | æ±‰å­—æ•°ç»„ | è¯—æ­Œæ–‡æœ¬ |
| 3 | æ··åˆè¯—æ­Œ | remix-poem | åŸè¯— + æ±‰å­— | æ–°è¯—æ–‡æœ¬ |
| 4 | ç”Ÿæˆæç¤ºè¯ | generate-image (æ­¥éª¤1) | è¯—æ­Œ | è‹±æ–‡æç¤ºè¯ |
| 5 | ç”Ÿæˆå›¾åƒ | generate-image (æ­¥éª¤2) | æç¤ºè¯ | å›¾åƒ Base64 |

### 7. å…³é”®æŠ€æœ¯ç‚¹

- **LLM è°ƒç”¨**ï¼šä½¿ç”¨ Z.ai SDK è°ƒç”¨å¤§è¯­è¨€æ¨¡å‹
- **è§’è‰²æ‰®æ¼”**ï¼šé€šè¿‡ç³»ç»Ÿæç¤ºè¯å®šä¹‰ AI çš„è§’è‰²
- **é“¾å¼è°ƒç”¨**ï¼šå›¾åƒç”Ÿæˆéœ€è¦å…ˆç”Ÿæˆæç¤ºè¯å†ç”Ÿæˆå›¾åƒ
- **Base64 ç¼–ç **ï¼šå›¾åƒä»¥ Base64 æ ¼å¼ä¼ è¾“
- **å¼‚æ­¥å¤„ç†**ï¼šæ‰€æœ‰ API è°ƒç”¨éƒ½æ˜¯å¼‚æ­¥çš„ï¼Œä½¿ç”¨ loading çŠ¶æ€ç®¡ç†
